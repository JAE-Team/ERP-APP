OBJECT Codeunit 50061 Menu_Projecte
{
  OBJECT-PROPERTIES
  {
    Date=03/03/23;
    Time=19:18:13;
    Modified=Yes;
    Version List=;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            // Codi 1 - Descripci¢: Consulta taula d'usuaris
            // Codi 2 - Descripci¢: Consulta transaccions d'un ususari
            // Codi 3 - Descripci¢: P…gina amb tots els usuaris
            // Codi 4 - Descripci¢: Estad¡stica del nombre de transaccions per dia
            // Codi 5 - Descripci¢: Estad¡stica de la quantitat de transaccions per dia

            CR := 13; // Carriage Return - (Hex $0D)
            LF := 10; // Line Feed - (Hex $0A)
            menuActiu := TRUE;

            WHILE menuActiu DO BEGIN
            input := Window.InputBox('Escull una opcio entre 1 i 5, altre caracter SORTIR'
            + FORMAT(CR)+FORMAT(LF)+ 'Codi 1 - Descripci¢: Consulta taula d usuaris'
            + FORMAT(CR)+FORMAT(LF)+ 'Codi 2 - Descripci¢: Consulta transaccions d un ususari'
            + FORMAT(CR)+FORMAT(LF)+ 'Codi 3 - Descripci¢: P…gina amb tots els usuaris'
            + FORMAT(CR)+FORMAT(LF)+ 'Codi 4 - Descripci¢: Estad¡stica del nombre de transaccions per dia'
            + FORMAT(CR)+FORMAT(LF)+ 'Codi 5 - Descripci¢: Estad¡stica de la quantitat de transaccions per dia'
            , 'IETI Corn', '', 100, 100);

            CASE input OF
               '1':
                BEGIN
                  Window.MsgBox('Descripci¢: Consulta taula d usuaris', 0, '');
                  idUsuari_2 := Window.InputBox('Introdueix l id de l usuari'
                  , 'IETI Corn', '', 100, 10);

                  found_2 := FALSE;
                  Usuari.SETFILTER(Usuari.userId, idUsuari_2);
                  WITH Usuari DO BEGIN
                    IF FIND('-') THEN
                      REPEAT
                        found_2 := TRUE;
                      UNTIL NEXT = 0;
                    END;

                IF(found_2 = FALSE) THEN BEGIN
                 Window.MsgBox('No s ha trobat l usuari', 0, '');
                  END;

                IF(found_2 = TRUE) THEN BEGIN
                 Window.MsgBox('Usuari trobat', 0, '');
                  END;

               END;
                 '2':
                BEGIN
                  Window.MsgBox('Codi 2 - Descripci¢: Consulta transaccions d un ususari', 0, '');
                  idUsuari_2 := Window.InputBox('Introdueix l id de l usuari'
                  , 'IETI Corn', '', 100, 10);

                  found_2 := FALSE;
                  Usuari.SETFILTER(Usuari.userId, idUsuari_2);
                  WITH Usuari DO BEGIN
                    IF FIND('-') THEN
                      REPEAT
                        found_2 := TRUE;
                      UNTIL NEXT = 0;
                    END;

                IF(found_2 = FALSE) THEN BEGIN
                 Window.MsgBox('No s ha trobat l usuari', 0, '');
                  END;

                IF(found_2 = TRUE) THEN BEGIN
                  MeuDialeg.OPEN('UsuariTransaccions\Emisor: #1######\Receptor: #2######\Quantitat: #3######\Data: #4######');
                  Transaccio.SETFILTER(Transaccio.userDestiny, idUsuari_2);
                  WITH Transaccio DO BEGIN
                    IF FIND('-') THEN
                      REPEAT
                        MeuDialeg.UPDATE(1,Transaccio.userOrigin);
                        MeuDialeg.UPDATE(2,Transaccio.userDestiny);
                        MeuDialeg.UPDATE(3,Transaccio.ammount);
                        MeuDialeg.UPDATE(4,Transaccio.timeFinish);
                        SLEEP(1000);
                      UNTIL NEXT = 0;
                    END;
                    Transaccio.RESET;
                    Transaccio.SETFILTER(Transaccio.userOrigin, idUsuari_2);
                    WITH Transaccio DO BEGIN
                      IF FIND('-') THEN
                        REPEAT
                          MeuDialeg.UPDATE(1,Transaccio.userOrigin);
                          MeuDialeg.UPDATE(2,Transaccio.userDestiny);
                          MeuDialeg.UPDATE(3,Transaccio.ammount);
                          MeuDialeg.UPDATE(4,Transaccio.timeFinish);
                          SLEEP(1000);
                        UNTIL NEXT = 0;
                      END;
                   END;

                END;
                 '3':
                BEGIN
                  Window.MsgBox('Codi 3 - Descripci¢: P…gina amb tots els usuaris', 0, '');
               END;
                 '4':
                BEGIN
                  Window.MsgBox('Codi 4 - Descripci¢: Estad¡stica del nombre de transaccions per dia', 0, '');
               END;
                 '5':
                BEGIN
                  Window.MsgBox('Codi 5 - Descripci¢: Estad¡stica de la quantitat de transaccions per dia', 0, '');
               END;
              ELSE
                BEGIN
                  menuActiu := FALSE;
                END;
              END;
            END;
          END;

  }
  CODE
  {
    VAR
      menuActiu@1106000000 : Boolean;
      Window@1106000002 : DotNet "'Microsoft.VisualBasic, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.Microsoft.VisualBasic.Interaction" RUNONCLIENT;
      input@1106000001 : Text;
      CR@1106000004 : Char;
      LF@1106000003 : Char;
      idUsuari_2@1106000005 : Text;
      MeuDialeg@1106000006 : Dialog;
      Usuari@1106000007 : Record 50021;
      Transaccio@1106000008 : Record 50022;
      found_2@1106000009 : Boolean;
    ;

    BEGIN
    END.
  }
}

